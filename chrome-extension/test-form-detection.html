<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Detection Test - Smart Form Guide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .form-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .required {
            color: red;
        }
        .form-title {
            color: #2563eb;
            margin-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }
        .test-info {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .test-info h3 {
            margin-top: 0;
            color: #1d4ed8;
        }
        .standalone-fields {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 6px;
            padding: 20px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h3>üß™ Form Detection Test Page</h3>
        <p>This page contains various form elements to test the Smart Form Guide extension's detection capabilities.</p>
        <p><strong>Instructions:</strong> Load the extension and click "Detect Forms" to see how many fields are detected.</p>
        <div id="debugInfo" style="margin-top: 10px; padding: 10px; background: #fef3c7; border-radius: 4px; display: none;">
            <strong>Debug Info:</strong>
            <div id="debugContent"></div>
        </div>
        <button onclick="testFormDetection()" style="margin-top: 10px; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
            üîç Test Form Detection (Manual)
        </button>
    </div>

    <!-- Main Form -->
    <div class="form-container">
        <h2 class="form-title">Solar Permit Application Form</h2>
        <form id="permitForm">
            <div class="form-group">
                <label for="applicantName">Applicant Name <span class="required">*</span></label>
                <input type="text" id="applicantName" name="applicantName" required>
            </div>

            <div class="form-group">
                <label for="email">Email Address <span class="required">*</span></label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone">
            </div>

            <div class="form-group">
                <label for="address">Property Address <span class="required">*</span></label>
                <input type="text" id="address" name="address" required>
            </div>

            <div class="form-group">
                <label for="city">City</label>
                <input type="text" id="city" name="city">
            </div>

            <div class="form-group">
                <label for="state">State</label>
                <select id="state" name="state">
                    <option value="">Select State</option>
                    <option value="CA">California</option>
                    <option value="NY">New York</option>
                    <option value="TX">Texas</option>
                </select>
            </div>

            <div class="form-group">
                <label for="zipCode">ZIP Code</label>
                <input type="text" id="zipCode" name="zipCode" pattern="[0-9]{5}">
            </div>

            <div class="form-group">
                <label for="systemSize">System Size (kW)</label>
                <input type="number" id="systemSize" name="systemSize" step="0.1">
            </div>

            <div class="form-group">
                <label for="installDate">Proposed Installation Date</label>
                <input type="date" id="installDate" name="installDate">
            </div>

            <div class="form-group">
                <label for="projectDescription">Project Description</label>
                <textarea id="projectDescription" name="projectDescription" placeholder="Describe your solar installation project..."></textarea>
            </div>

            <div class="form-group">
                <label for="contractorCompany">Contractor Company</label>
                <input type="text" id="contractorCompany" name="contractorCompany">
            </div>

            <div class="form-group">
                <label for="estimatedCost">Estimated Project Cost</label>
                <input type="number" id="estimatedCost" name="estimatedCost" step="0.01">
            </div>

            <!-- Hidden field (should be ignored) -->
            <input type="hidden" name="formId" value="solar-permit-2024">
            
            <!-- Submit button (should be ignored) -->
            <input type="submit" value="Submit Application">
        </form>
    </div>

    <!-- Standalone Fields (not in a form) -->
    <div class="standalone-fields">
        <h3>Standalone Fields (Not in Form)</h3>
        <div class="form-group">
            <label for="standaloneEmail">Notification Email</label>
            <input type="email" id="standaloneEmail" name="standaloneEmail">
        </div>
        
        <div class="form-group">
            <label for="standaloneNotes">Additional Notes</label>
            <textarea id="standaloneNotes" name="standaloneNotes"></textarea>
        </div>
    </div>

    <!-- Fields with different labeling methods -->
    <div class="form-container">
        <h2 class="form-title">Different Labeling Methods Test</h2>
        
        <!-- Aria-label -->
        <div class="form-group">
            <input type="text" aria-label="Customer Reference Number" placeholder="Enter reference number">
        </div>
        
        <!-- Aria-labelledby -->
        <div class="form-group">
            <span id="utilityLabel">Utility Company</span>
            <input type="text" aria-labelledby="utilityLabel">
        </div>
        
        <!-- Label without 'for' attribute -->
        <div class="form-group">
            <label>Property Owner Name</label>
            <input type="text" name="propertyOwner">
        </div>
    </div>

    <script>
        // Test form detection manually
        function testFormDetection() {
            const debugInfo = document.getElementById('debugInfo');
            const debugContent = document.getElementById('debugContent');

            // Count form elements manually
            const forms = document.querySelectorAll('form');
            const inputs = document.querySelectorAll('input, select, textarea');
            const visibleInputs = Array.from(inputs).filter(input => {
                const style = window.getComputedStyle(input);
                return style.display !== 'none' &&
                       style.visibility !== 'hidden' &&
                       input.type !== 'hidden' &&
                       input.type !== 'submit' &&
                       input.type !== 'button';
            });

            debugContent.innerHTML = `
                <div>Forms found: ${forms.length}</div>
                <div>Total inputs: ${inputs.length}</div>
                <div>Visible fillable inputs: ${visibleInputs.length}</div>
                <div>Extension content script loaded: ${window.formAssistantInstance ? 'Yes' : 'No'}</div>
                <div>Chrome extension API available: ${typeof chrome !== 'undefined' && chrome.runtime ? 'Yes' : 'No'}</div>
            `;
            debugInfo.style.display = 'block';

            console.log('üß™ Manual form detection test:', {
                forms: forms.length,
                totalInputs: inputs.length,
                visibleInputs: visibleInputs.length,
                contentScriptLoaded: !!window.formAssistantInstance,
                chromeApiAvailable: typeof chrome !== 'undefined' && !!chrome.runtime
            });
        }

        // Add some dynamic behavior to test mutation observer
        setTimeout(() => {
            const dynamicContainer = document.createElement('div');
            dynamicContainer.className = 'form-container';
            dynamicContainer.innerHTML = `
                <h3>Dynamically Added Field</h3>
                <div class="form-group">
                    <label for="dynamicField">Dynamic Field</label>
                    <input type="text" id="dynamicField" name="dynamicField" placeholder="This field was added dynamically">
                </div>
            `;
            document.body.appendChild(dynamicContainer);
            console.log('üîÑ Dynamic field added to test mutation observer');
        }, 3000);

        // Check if extension is loaded
        setTimeout(() => {
            if (window.formAssistantInstance) {
                console.log('‚úÖ Smart Form Guide extension is loaded and active');
            } else {
                console.log('‚ùå Smart Form Guide extension not detected');
            }
        }, 1000);
    </script>
</body>
</html>
